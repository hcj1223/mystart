# 归并排序

```c++
int tmp[N]; //用于暂时储存元素的数组
void merge(int q[], int l, int r)
{
    if (l >= r)
        return; //只有一个元素
    int mid = l + r >> 1;
    merge(q, l, mid), merge(q, mid + 1, r); //递归两边
    int i = l, j = mid + 1, k = 0;
    while (i <= mid && j <= r)
        if (q[i] <= q[j])
            tmp[k++] = q[i++];
        else
            tmp[k++] = q[j++]; //将小的元素放入数组
    while (i <= mid)
        tmp[k++] = q[i++]; //将左边剩余部分插入数组
    while (j <= r)
        tmp[k++] = q[j++]; //将右边剩余部分插入数组
    for (i = l, j = 0; i <= r; i++, j++)
        q[i] = tmp[j]; //用tmp[]替换原数组
}
```

------

# 求逆序对个数

```c++
long long qsort(int l, int r)
{
    if (l >= r)
        return 0;
    int mid = l + r >> 1;
    long long res = qsort(l, mid) + qsort(mid + 1, r);
    int i = l, j = mid + 1, k = 0;
    while (i <= mid && j <= r)
        if (a[i] <= a[j])
            t[k++] = a[i++];
        else
        {
            res += mid - i + 1;
            t[k++] = a[j++];
        }
    while (i <= mid)
        t[k++] = a[i++];
    while (j <= r)
        t[k++] = a[j++];
    for (int i = l, j = 0; i <= r; i++, j++)
        a[i] = t[j];
    return res;
}
```

