# 手写堆

```c++
int h[N], size, ph[N], hp[N]; // ph[i]存储第i个数在堆中的位置,hp[i]存储堆中第i个值对应的数
ph[++m] = size, hp[size] = m; // ph[], hp[]初始化

void up(int u)
{
    while (u / 2 && h[u / 2] > h[u])
    {
        swap(h[u / 2], h[u]); // heap_swap(u / 2, u)
        u /= 2;
    }
}
void down(int u)
{
    int t = u;
    if (u * 2 <= size && h[u * 2] < h[t])
        t = u * 2; //左儿子
    if (u * 2 + 1 <= size && h[u * 2 + 1] < h[t])
        t = u * 2 + 1; //右儿子
    if (u != t)
    {
        swap(h[u], h[t]); // heap_swap(u, t)
        down(t);
    }
}

//堆排序
for (int i = n / 2; i; i--) down(i);
//集合中最小值
h[1]
//删除第k个元素
swap(h[k], h[size]); // k = ph[k], heap_swap(k, size) 
size--; down(k), up(k);
//修改任意元素
h[k] = x; // k = ph[k]
down(k), up(k);

//堆交换
void heap_swap(int a, int b) //所有swap改为heap_swap
{
    swap(ph[hp[a]], ph[hp[b]]);
    swap(hp[a], hp[b]);
    swap(h[a], h[b]);
}
```